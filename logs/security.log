2025-06-25 05:17:42,702 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:17:42,702 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:17:42,712 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:17:42,713 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:17:42,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:17:42,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:17:42,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:17:42,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 12, 52, 42, 723775), 'iat': datetime.datetime(2025, 6, 25, 12, 17, 42, 723780)}
2025-06-25 05:17:42,724 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:17:44,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:17:44,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:17:44,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:17:46,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:17:46,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,886 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:17:46,907 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:17:46,907 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,556 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,557 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,558 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,558 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,564 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,564 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,564 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,595 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,595 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,596 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,616 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,617 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,618 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,657 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,699 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,700 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:16,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:16,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:16,952 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:16,952 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:16,952 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:16,973 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:16,973 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:16,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:17,001 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:17,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:17,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:17,639 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,639 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,639 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:17,957 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:17,958 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:19,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:19,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:19,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:19,846 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:19,846 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:19,880 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:19,881 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:40,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:40,966 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:40,982 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:40,983 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:48,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:48,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:48,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:48,215 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:48,215 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:48,229 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:48,229 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:19:17,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:19:17,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:19:17,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:17,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:17,438 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:19:17,448 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:19:17,448 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:19:40,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:19:40,950 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:19:40,951 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:40,951 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:40,952 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:19:40,993 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:19:40,994 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:03,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:20:03,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:20:03,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:03,567 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:03,567 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:20:03,580 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:20:03,581 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:17,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:20:17,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:20:17,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:17,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:17,752 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:20:17,759 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:20:17,760 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:33,499 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:20:33,499 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:27:34,803 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:27:34,804 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:27:34,831 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:27:34,832 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:27:34,847 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:27:34,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:27:34,847 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:27:34,848 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 2, 34, 847575), 'iat': datetime.datetime(2025, 6, 25, 12, 27, 34, 847580)}
2025-06-25 05:27:34,848 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:27:40,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:40,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:40,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:40,817 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:40,817 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:40,837 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:40,838 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,189 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,189 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,189 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,191 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,191 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:42,203 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:42,204 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,204 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:42,778 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:42,778 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,420 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:53,428 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:53,428 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,937 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,937 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:27:53,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,943 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,945 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:53,979 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:53,980 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,980 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:10,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:10,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,912 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:10,928 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:10,929 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:14,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:14,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:14,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:14,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:14,734 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:14,753 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:14,753 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:17,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:17,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:17,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:17,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:17,630 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:17,638 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:17,638 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:21,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:21,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:21,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:21,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:21,025 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:21,097 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:21,097 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:28,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:28,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:28,960 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:28,960 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:28,961 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:28,982 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:28,987 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:52,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:52,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:52,990 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:52,990 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:52,990 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:53,006 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:53,006 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:56,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:56,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:56,735 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:56,735 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:56,736 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:56,749 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:56,750 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:29:32,314 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:29:32,315 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:36:55,622 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:36:55,622 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:36:55,641 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:36:55,641 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:36:55,657 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:36:55,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:36:55,657 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:36:55,658 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 11, 55, 657819), 'iat': datetime.datetime(2025, 6, 25, 12, 36, 55, 657826)}
2025-06-25 05:36:55,659 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:37:01,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:01,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:01,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:01,780 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:01,780 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,794 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:01,801 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:01,801 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:03,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:03,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:03,349 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:03,349 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:03,349 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:05,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:05,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:05,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:05,294 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:05,294 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:05,302 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:05,303 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,134 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,134 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,135 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,135 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:06,141 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:06,142 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:06,142 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,015 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,015 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,016 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:07,023 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:07,023 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:07,023 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:10,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:10,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:10,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:10,138 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:10,138 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:10,144 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:10,145 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:19,355 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:19,356 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,356 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,357 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:19,368 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:19,369 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:25,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:25,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,093 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,093 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:25,094 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,094 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,095 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:25,102 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:25,103 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:25,103 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:38,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:38,500 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:38,500 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:38,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:38,501 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:38,508 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:38,509 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:47,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:47,170 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:47,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:47,170 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:47,171 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:47,196 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:47,199 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:51,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:51,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:51,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:51,022 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:51,023 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:51,056 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:51,057 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:53,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:53,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:53,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:53,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:53,243 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:53,251 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:53,251 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:54,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:54,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:54,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:54,610 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:54,610 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:54,642 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:54,643 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:05,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:05,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:05,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:05,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:05,046 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:05,081 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:05,081 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:10,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:10,157 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:10,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:10,158 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:10,158 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:10,175 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:10,175 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:17,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:17,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:17,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:17,440 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:17,441 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:17,478 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:17,478 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:21,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:21,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:21,719 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:21,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:21,720 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:21,742 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:21,743 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:32,117 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:32,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:32,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:32,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:32,120 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:32,137 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:32,138 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:53,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:53,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:53,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:53,460 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:53,460 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:53,480 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:53,481 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:39:12,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:39:12,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:39:12,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:39:12,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:39:12,897 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:39:12,904 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:39:12,904 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:39:14,240 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:39:14,240 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:45:53,395 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:45:53,395 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:45:53,408 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:45:53,409 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:45:53,417 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:45:53,417 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 20, 53, 417133), 'iat': datetime.datetime(2025, 6, 25, 12, 45, 53, 417136)}
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:45:57,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:57,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:57,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:45:57,909 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 05:45:58,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:58,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:58,429 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:45:58,431 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 05:45:58,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:58,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:58,631 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:46:05,201 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:46:05,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:46:05,202 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:46:05,202 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 25, 13, 16, 5, 201548), 'iat': datetime.datetime(2025, 6, 25, 12, 46, 5, 201571)}
2025-06-25 05:46:05,202 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:46:05,202 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE0NjAzNjUsImlhdCI6MTc1MDg1NTU2NX0.nTsRIyyyl0BRDJbFZvzy3H9uOH5qq0KbaabiFbpJEM0, Expiry (seconds): 604800
2025-06-25 05:46:05,208 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-25 05:46:06,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,674 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,674 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,675 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,685 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,685 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,685 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,700 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,700 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,701 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,701 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,712 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,713 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,713 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,731 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,731 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,763 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,763 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:07,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:07,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:07,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:07,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:07,417 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:07,425 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:07,425 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:07,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:07,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:07,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:09,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:09,347 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,347 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,347 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:09,361 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:09,362 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:09,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:09,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:09,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,387 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,387 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:09,484 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:09,485 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:47:09,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:47:09,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:47:09,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:47:09,523 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:47:09,523 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:47:09,532 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:47:09,533 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:48:09,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:48:09,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:48:09,530 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:48:09,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:48:09,530 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:48:09,545 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:48:09,546 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:52:31,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:52:31,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:52:31,554 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:52:31,554 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:52:31,554 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:52:31,566 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:52:31,566 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:53:57,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:53:57,593 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:53:57,600 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:53:57,601 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:54:02,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:54:02,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:54:02,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:02,866 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:02,866 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:54:02,874 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:54:02,874 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:54:09,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:54:09,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:54:09,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:09,517 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:09,517 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:54:09,522 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:54:09,522 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:55:03,529 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:55:03,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:55:03,531 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:03,531 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:03,531 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:55:03,544 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:55:03,545 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:09,601 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:09,601 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:55:09,605 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:55:09,606 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:03,732 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:03,732 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:56:03,738 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:56:03,738 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:25,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:25,845 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:56:25,849 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:56:25,849 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:14:05,406 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:05,407 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:07,489 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:14:07,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:14:07,489 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:14:07,489 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 4, 49, 7, 489333), 'iat': datetime.datetime(2025, 6, 26, 4, 14, 7, 489337)}
2025-06-25 21:14:07,490 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:14:25,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,232 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,234 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,243 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,244 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,246 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,276 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,284 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,347 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,347 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,348 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,352 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:28,907 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:28,907 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:59,122 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:59,123 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:59,146 - WARNING - app.core.security - AOF persistence is not enabled in Redis. Attempting to enable it...
2025-06-25 21:14:59,154 - INFO - app.core.security - AOF persistence has been enabled with appendfsync=everysec
2025-06-25 21:14:59,155 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:15:00,287 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:15:00,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:15:00,288 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:15:00,288 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 4, 45, 0, 287909), 'iat': datetime.datetime(2025, 6, 26, 4, 15, 0, 287917)}
2025-06-25 21:15:00,290 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:15:00,291 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MTYxMDAsImlhdCI6MTc1MDkxMTMwMH0.CXeMYmz-n8w8EUA68tjEEBa3pQYM6H6vxNpSBj-wHKQ, Expiry (seconds): 604800
2025-06-25 21:15:00,294 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,408 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,408 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,409 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,409 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,418 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,418 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,418 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,570 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,570 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,571 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:15:01,571 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,571 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,572 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,572 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,575 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,604 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,605 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,605 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,639 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,639 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,639 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,666 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,667 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:02,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:02,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:02,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:02,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:02,848 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:02,863 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:02,863 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:02,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:02,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:02,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:03,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,271 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:03,421 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:03,421 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:04,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:04,808 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:04,833 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:04,833 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:46,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:46,919 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:46,924 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:46,924 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:03,685 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:03,685 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:03,692 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:03,692 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,774 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,775 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,775 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,782 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,782 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,835 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,835 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,837 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,850 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,850 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,850 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,864 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,864 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,865 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,875 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,876 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,876 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,186 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,186 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,186 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:15,192 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:15,192 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,863 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:15,869 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:15,869 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:17,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:17,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,007 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:17,016 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:17,016 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:17:16,534 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:17:16,534 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:17:16,541 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:17:16,541 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:17:51,872 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:17:51,872 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:17:51,887 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:17:51,887 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:17:51,897 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:17:51,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:17:51,897 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:17:51,897 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 4, 52, 51, 897837), 'iat': datetime.datetime(2025, 6, 26, 4, 17, 51, 897840)}
2025-06-25 21:17:51,898 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:18:08,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:08,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:08,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,820 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:14,825 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:14,825 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:28,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:28,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:28,604 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:28,604 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:28,605 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,373 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,373 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,374 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:33,380 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:33,380 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:33,380 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:08,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:08,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:08,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:08,176 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:08,176 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:08,180 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:08,180 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:14,769 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:14,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:14,770 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:14,770 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:14,770 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:14,774 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:14,774 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:18,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:18,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:18,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:18,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:18,401 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:18,414 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:18,415 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:20:15,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:20:15,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:20:15,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:15,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:15,872 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:20:15,877 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:20:15,878 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:20:52,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:20:52,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:20:52,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:52,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:52,150 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:20:52,162 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:20:52,162 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:21:17,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:21:17,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:21:17,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:21:17,513 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:21:17,513 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:21:17,533 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:21:17,534 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:10,287 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:10,287 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:10,309 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:10,313 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:14,776 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:14,776 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:14,792 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:14,793 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:26,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:26,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:26,190 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:26,190 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:26,190 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:26,235 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:26,235 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:23:16,427 - INFO - app.core.security - Closing Redis connection...
2025-06-25 21:23:16,427 - INFO - app.core.security - Redis connection closed.
2025-06-25 21:31:36,649 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:31:36,649 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:31:36,665 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:31:36,665 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:31:36,676 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:31:36,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:31:36,676 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:31:36,676 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 6, 36, 676612), 'iat': datetime.datetime(2025, 6, 26, 4, 31, 36, 676614)}
2025-06-25 21:31:36,677 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:31:38,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:38,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:38,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,971 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:47,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:47,973 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,974 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,974 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:31:47,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:47,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:47,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,975 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,975 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:31:47,999 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:31:48,001 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:48,005 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:52,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,431 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,431 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:52,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:52,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,432 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,433 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:31:52,443 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:31:52,444 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:52,444 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:01,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:01,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:01,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:01,490 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:01,491 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:01,506 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:01,507 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:05,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:05,612 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:05,615 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:05,615 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,119 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,119 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:06,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,120 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:06,130 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:06,130 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:06,130 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:15,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:15,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:15,676 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:15,676 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:15,676 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:15,680 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:15,680 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:34,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:34,528 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:34,529 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:34,529 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:34,529 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:34,531 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:34,531 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:45,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:45,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:45,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:45,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:45,472 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:45,483 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:45,484 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:53,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:53,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:53,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:53,786 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:53,786 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:53,791 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:53,791 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:54,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:54,071 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:54,082 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:54,083 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:00,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:00,565 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:00,568 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:00,568 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:05,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:05,053 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:05,055 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:05,055 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:14,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:14,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:14,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:14,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:14,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:14,781 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:14,782 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:45,783 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:45,783 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:45,789 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:45,789 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:54,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:54,299 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:54,302 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:54,302 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,051 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,051 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:05,055 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:05,055 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,102 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,102 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:05,106 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:05,106 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:14,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:14,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:14,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:14,772 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:14,772 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:14,779 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:14,779 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:15,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:15,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:15,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:15,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:15,371 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:15,391 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:15,391 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:19,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:19,777 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:19,777 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:19,778 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:19,778 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:19,794 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:19,795 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:23,035 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:23,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:23,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:23,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:23,036 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:23,048 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:23,048 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:27,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:27,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:27,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:27,017 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:27,017 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:27,027 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:27,028 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:33,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:33,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:33,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:33,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:33,179 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:33,193 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:33,193 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:39,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:39,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,784 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,784 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:39,785 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,785 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,785 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:40,092 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:40,092 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,092 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:40,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,846 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,846 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:40,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,847 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,847 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:40,857 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:40,857 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,857 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:42,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:42,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:42,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,290 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,291 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:42,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:42,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:42,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,292 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,292 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:42,300 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:42,300 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:42,300 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,216 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,216 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:43,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:43,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:43,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,217 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,217 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:43,230 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:43,230 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:43,231 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,963 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,963 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:44,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:44,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,964 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,964 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:44,975 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:44,977 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:44,977 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,078 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,078 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,079 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,079 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,094 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,095 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,095 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,104 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,104 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,106 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,106 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,106 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,122 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,122 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,907 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,908 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,908 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:46,908 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,908 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,909 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,909 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,920 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,920 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,921 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,740 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:48,748 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:48,748 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:48,748 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,865 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:50,873 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:50,873 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:50,874 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:54,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:54,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:54,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:54,579 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:54,579 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:54,588 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:54,589 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:05,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:05,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:05,127 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:05,127 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:05,127 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:05,140 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:05,143 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:14,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:14,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:14,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:14,776 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:14,776 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:14,783 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:14,783 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:45,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:45,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:45,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:45,481 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:45,481 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:45,494 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:45,494 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:54,068 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:54,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:54,070 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:54,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:54,071 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:54,090 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:54,090 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:36:05,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:36:05,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:36:05,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:05,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:05,065 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:36:05,091 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:36:05,092 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:36:14,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:36:14,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:36:14,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:14,801 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:14,801 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:36:14,817 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:36:14,817 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:37:17,822 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:37:17,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:37:17,823 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:37:17,823 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:37:17,823 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:37:17,878 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:37:17,879 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:02,406 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:02,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:02,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:02,412 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:02,412 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:02,443 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:02,443 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:04,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:04,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:04,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:04,552 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:04,552 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:04,566 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:04,567 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:48,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:48,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:48,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:48,295 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:48,295 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:48,337 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:48,343 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:50,351 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:50,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:50,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:50,354 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:50,354 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:50,390 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:50,390 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:57,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:57,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:57,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,242 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,243 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:57,259 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:57,260 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:57,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:57,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:57,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,318 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:57,342 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:57,342 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:02,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:02,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:02,539 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:02,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:02,540 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:02,552 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:02,553 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:05,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:05,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:05,059 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:05,059 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:05,059 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:05,077 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:05,077 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:14,783 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:14,783 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:14,796 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:14,797 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:45,468 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:45,469 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:45,487 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:45,487 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:54,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:54,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:54,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:54,084 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:54,084 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:54,140 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:54,140 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:02,539 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:02,539 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:02,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:02,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:02,541 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:02,558 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:02,558 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:05,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:05,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:05,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:05,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:05,064 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:05,088 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:05,088 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:14,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:14,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:14,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:14,782 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:14,782 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:14,793 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:14,793 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:16,112 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:16,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:16,113 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:16,113 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:16,113 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:16,123 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:16,123 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:27,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:27,680 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:27,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:27,683 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:27,683 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:27,769 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:27,771 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:39,514 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:39,514 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:39,528 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:39,528 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:45,548 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:45,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:45,549 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:45,550 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:45,552 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:45,560 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:45,560 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:51,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:51,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:51,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:51,523 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:51,523 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:51,547 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:51,547 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:54,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:54,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:54,089 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:54,089 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:54,089 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:54,111 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:54,111 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:00,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:00,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:00,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:00,893 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:00,893 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:00,936 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:00,937 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:02,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:02,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:02,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:02,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:02,555 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:02,568 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:02,568 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:05,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:05,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:05,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:05,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:05,057 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:05,073 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:05,074 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:07,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:07,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:07,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:07,515 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:07,515 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:07,538 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:07,539 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:14,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:14,863 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:14,922 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:14,923 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:16,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:16,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:16,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:16,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:16,065 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:16,089 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:16,090 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:43,173 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:46:43,173 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:46:43,188 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:46:43,188 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:46:43,203 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:46:43,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:46:43,203 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:46:43,203 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 21, 43, 203237), 'iat': datetime.datetime(2025, 6, 26, 4, 46, 43, 203240)}
2025-06-25 21:46:43,203 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:46:50,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:50,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:50,655 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:50,658 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:50,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:50,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:50,669 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:50,671 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:50,939 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:50,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:50,939 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:50,940 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:54,463 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:54,464 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:54,464 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:54,466 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:54,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:54,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:54,514 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:54,516 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:54,526 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:54,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:54,526 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:57,995 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:46:57,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:46:57,995 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:46:57,995 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 5, 16, 57, 995121), 'iat': datetime.datetime(2025, 6, 26, 4, 46, 57, 995134)}
2025-06-25 21:46:57,996 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:46:57,996 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MTgwMTcsImlhdCI6MTc1MDkxMzIxN30.bDfW65EZoEdKvXoN9lWyP6d8EMpIR0YWv0jZ3_qua0g, Expiry (seconds): 604800
2025-06-25 21:46:58,000 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-25 21:46:59,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,140 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,140 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,140 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:46:59,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,141 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:46:59,150 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:46:59,151 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,151 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,166 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,167 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,168 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,168 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:46:59,172 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,174 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,178 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,178 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:46:59,205 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:46:59,206 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,206 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,231 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,231 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:46:59,278 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:46:59,279 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,507 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,507 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,508 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,508 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,509 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:46:59,559 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:46:59,559 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:01,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:01,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:01,442 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:01,442 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:01,442 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:01,469 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:01,469 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:01,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:01,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:01,494 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:04,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:04,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:04,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:04,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:04,438 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:04,487 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:04,487 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:18,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:18,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:18,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,964 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,964 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:47:18,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:18,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:18,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,964 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,964 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:18,972 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:18,972 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:18,972 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:18,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:18,982 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:18,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,983 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,983 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:47:18,983 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:18,983 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:18,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,983 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,983 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:18,998 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:18,998 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:18,998 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:19,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:19,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:19,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:19,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:19,018 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:19,038 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:19,038 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:20,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:20,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:20,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:20,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:20,269 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:20,286 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:20,286 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:20,305 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:20,305 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:20,306 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:21,298 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:21,298 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:21,298 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:21,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:21,299 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:21,378 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:21,378 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:23,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:23,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:23,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:23,450 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:23,450 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:23,503 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:23,503 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,690 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,690 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:47:37,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,691 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,691 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:37,699 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:37,700 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,700 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,716 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,716 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,716 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:47:37,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,728 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,743 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,743 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:37,763 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:37,763 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,764 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,795 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,795 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,795 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:37,871 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:37,872 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:38,041 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:38,041 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:38,041 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:38,042 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:38,042 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:38,210 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:38,211 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:39,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:39,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:39,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:39,779 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:39,779 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:39,796 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:39,796 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:39,805 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:39,805 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:39,805 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:42,466 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:42,466 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:42,467 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:42,467 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:42,467 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:42,498 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:42,498 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:48:37,869 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:48:37,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:48:37,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:48:37,870 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:48:37,870 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:48:37,884 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:48:37,885 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:48:51,174 - INFO - app.core.security - Closing Redis connection...
2025-06-25 21:48:51,175 - INFO - app.core.security - Redis connection closed.
2025-06-25 21:54:00,676 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:54:00,676 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:54:00,689 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:54:00,689 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:54:00,699 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:54:00,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:54:00,699 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:54:00,699 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 29, 0, 699634), 'iat': datetime.datetime(2025, 6, 26, 4, 54, 0, 699640)}
2025-06-25 21:54:00,700 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:54:11,537 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:11,537 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:11,538 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,538 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,538 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:11,547 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:11,547 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:11,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:11,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:11,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,886 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:11,890 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:11,890 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,979 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,979 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,979 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,979 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:11,985 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:11,985 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:11,985 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:12,007 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,016 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,016 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:54:12,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,016 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,016 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:12,024 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:12,024 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:12,025 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:12,163 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,163 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,164 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,164 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,164 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:12,169 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:12,169 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:12,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,732 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,732 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:12,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,758 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:12,758 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:14,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:14,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:14,143 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:14,144 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:14,144 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:14,154 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:14,154 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,035 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,036 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,037 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,037 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:54:19,037 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,037 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,037 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,038 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,038 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:19,046 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:19,046 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,046 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,077 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,081 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,082 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:54:19,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,082 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,083 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:19,160 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:19,161 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,161 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,195 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,196 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,197 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:19,224 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:19,224 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:20,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:20,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:20,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:20,744 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:20,744 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:20,768 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:20,769 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:20,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:20,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:20,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:21,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:21,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:21,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:21,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:21,648 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:22,019 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:22,020 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:24,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:24,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:24,020 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:24,021 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:24,021 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:24,072 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:24,073 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:43,838 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:43,838 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:43,839 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:43,839 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:43,839 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:43,901 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:43,902 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:48,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:48,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:48,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:48,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:48,827 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:48,845 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:48,847 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:52,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:52,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:52,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:52,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:52,612 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:52,630 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:52,632 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:55:00,000 - INFO - app.core.security - Closing Redis connection...
2025-06-25 21:55:00,001 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:03:30,000 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:03:30,000 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:03:30,007 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:03:30,007 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:03:30,024 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:03:30,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:03:30,024 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:03:30,024 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 38, 30, 24096), 'iat': datetime.datetime(2025, 6, 26, 5, 3, 30, 24099)}
2025-06-25 22:03:30,024 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:03:36,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:36,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:36,905 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:36,905 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:36,906 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 22:03:36,943 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 22:03:36,943 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 22:03:36,944 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTA5MTUwMTcsImlhdCI6MTc1MDkxMzIxN30.b-ZMTFc_Ja_sEW_GKrYGuaX25uII5cwEAB4bDpM20yA
2025-06-25 22:03:36,949 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTA5MTUwMTcsImlhdCI6MTc1MDkxMzIxN30.b-ZMTFc_Ja_sEW_GKrYGuaX25uII5cwEAB4bDpM20yA
2025-06-25 22:03:38,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:38,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:38,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:38,028 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:38,028 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 22:03:38,032 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 22:03:38,033 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 22:03:38,086 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:38,087 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:38,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:38,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:38,088 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 22:03:38,102 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 22:03:38,103 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 22:03:40,551 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:03:40,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:03:40,551 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:03:40,551 - DEBUG - app.core.security - Payload to encode: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': datetime.datetime(2025, 6, 26, 5, 33, 40, 551046), 'iat': datetime.datetime(2025, 6, 26, 5, 3, 40, 551057)}
2025-06-25 22:03:40,552 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:03:40,552 - INFO - app.core.security - Storing refresh token for user ID 9 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTE1MTkwMjAsImlhdCI6MTc1MDkxNDIyMH0.EqCA7daInEDIx9tdDbvttmAtGlsX-O_qOg4dJ5OmCSY, Expiry (seconds): 604800
2025-06-25 22:03:40,557 - INFO - app.core.security - Refresh token stored successfully for user ID: 9
2025-06-25 22:03:41,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:41,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:41,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:41,951 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:41,953 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:03:41,953 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:41,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:41,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:41,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:41,971 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:42,054 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:42,054 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:42,054 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:42,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:42,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:42,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,083 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,083 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:03:42,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:42,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:42,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,088 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:42,148 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:42,152 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:42,152 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:42,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:42,166 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:42,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,168 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,168 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:42,199 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:42,199 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:43,390 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:43,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:43,391 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:43,395 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:43,395 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:43,418 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:43,421 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:43,468 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:43,468 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:43,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:44,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:44,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:44,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:44,567 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:44,567 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:44,836 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:44,837 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:46,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:46,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:46,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:46,443 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:46,444 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:46,461 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:46,462 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:04:02,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:04:02,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:04:02,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:02,890 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:02,891 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:04:02,938 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:04:02,941 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:04:05,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:04:05,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:04:05,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:05,686 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:05,686 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:04:05,721 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:04:05,722 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:04:10,382 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:04:10,382 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:04:10,382 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:10,382 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:10,382 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:04:10,396 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:04:10,399 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:07,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:07,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:07,159 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:07,160 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:07,160 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:07,175 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:07,176 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:07,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:07,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:07,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:07,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:07,282 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:07,289 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:07,289 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:08,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:08,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:08,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:08,433 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:08,433 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:08,442 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:08,443 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:08,473 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:08,474 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:08,475 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:09,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:09,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:09,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:09,786 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:09,787 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:09,806 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:09,807 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:49,318 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:49,318 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:49,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:49,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:49,318 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:49,323 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:49,324 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:06:07,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:06:07,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:06:07,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:07,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:07,687 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:06:07,696 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:06:07,696 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:06:49,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:06:49,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:06:49,020 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:49,020 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:49,020 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:06:49,026 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:06:49,026 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:06:50,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:06:50,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:06:50,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:50,653 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:50,653 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:06:50,660 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:06:50,660 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:07:07,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:07:07,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:07:07,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:07,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:07,675 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:07:07,681 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:07:07,681 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:07:49,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:07:49,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:07:49,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,838 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,838 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:07:49,848 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:07:49,848 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:07:49,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:07:49,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:07:49,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,897 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:07:49,911 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:07:49,911 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:07:49,943 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:07:49,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:07:49,944 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,944 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,945 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:07:49,958 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:07:49,958 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:08:02,868 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:08:02,869 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:11:42,943 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:11:42,944 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:11:42,962 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:11:42,963 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:11:42,978 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:11:42,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:11:42,978 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:11:42,978 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 46, 42, 978617), 'iat': datetime.datetime(2025, 6, 26, 5, 11, 42, 978621)}
2025-06-25 22:11:42,982 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:18:23,995 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:18:23,995 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:18:27,420 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:18:27,420 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:18:27,431 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:18:27,431 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:18:27,438 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:18:27,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:18:27,438 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:18:27,438 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 53, 27, 438339), 'iat': datetime.datetime(2025, 6, 26, 5, 18, 27, 438341)}
2025-06-25 22:18:27,438 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:21:27,927 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:21:27,928 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:30:37,529 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:30:37,529 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:30:37,541 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:30:37,541 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:30:37,549 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:30:37,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:30:37,549 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:30:37,549 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 5, 37, 549394), 'iat': datetime.datetime(2025, 6, 26, 5, 30, 37, 549397)}
2025-06-25 22:30:37,549 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:32:38,655 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:32:38,671 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:40:05,609 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:40:05,609 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:40:05,631 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:40:05,631 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:40:05,650 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:40:05,650 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:40:05,650 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:40:05,650 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 15, 5, 650571), 'iat': datetime.datetime(2025, 6, 26, 5, 40, 5, 650576)}
2025-06-25 22:40:05,652 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:40:21,342 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:40:21,343 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:40:24,702 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:40:24,702 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:40:24,714 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:40:24,715 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:40:24,727 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:40:24,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:40:24,727 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:40:24,727 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 15, 24, 727453), 'iat': datetime.datetime(2025, 6, 26, 5, 40, 24, 727458)}
2025-06-25 22:40:24,728 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:40:41,922 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:40:41,922 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:40:44,483 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:40:44,483 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:40:44,499 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:40:44,499 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:40:44,506 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:40:44,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:40:44,506 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:40:44,506 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 15, 44, 506550), 'iat': datetime.datetime(2025, 6, 26, 5, 40, 44, 506552)}
2025-06-25 22:40:44,507 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:42:35,470 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:42:35,471 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:42:38,771 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:42:38,772 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:42:38,783 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:42:38,783 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:42:38,794 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:42:38,794 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:42:38,794 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:42:38,794 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 17, 38, 794548), 'iat': datetime.datetime(2025, 6, 26, 5, 42, 38, 794556)}
2025-06-25 22:42:38,795 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:43:01,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:43:01,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:43:01,643 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-25 22:43:01,648 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 22:43:23,689 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:43:23,691 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:43:26,464 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:43:26,464 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:43:26,473 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:43:26,474 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:43:26,481 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:43:26,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:43:26,481 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:43:26,481 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 18, 26, 481386), 'iat': datetime.datetime(2025, 6, 26, 5, 43, 26, 481389)}
2025-06-25 22:43:26,482 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:43:28,768 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:43:28,768 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:43:31,684 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:43:31,684 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:43:31,697 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:43:31,697 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:43:31,706 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:43:31,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:43:31,707 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:43:31,707 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 18, 31, 706891), 'iat': datetime.datetime(2025, 6, 26, 5, 43, 31, 706896)}
2025-06-25 22:43:31,707 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:44:12,560 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:44:12,563 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:44:16,023 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:44:16,023 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:44:16,029 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:44:16,030 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:44:16,035 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:44:16,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:44:16,035 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:44:16,035 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 19, 16, 35509), 'iat': datetime.datetime(2025, 6, 26, 5, 44, 16, 35512)}
2025-06-25 22:44:16,035 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:44:19,419 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:44:19,419 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:44:23,061 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:44:23,061 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:44:23,077 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:44:23,077 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:44:23,090 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:44:23,090 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:44:23,090 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:44:23,090 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 19, 23, 90471), 'iat': datetime.datetime(2025, 6, 26, 5, 44, 23, 90475)}
2025-06-25 22:44:23,091 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:44:24,901 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:44:24,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:44:24,902 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-25 22:44:24,909 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 22:45:12,244 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:45:12,246 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:45:15,389 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:45:15,389 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:45:15,403 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:45:15,403 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:45:15,414 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:45:15,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:45:15,414 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:45:15,414 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 20, 15, 414051), 'iat': datetime.datetime(2025, 6, 26, 5, 45, 15, 414056)}
2025-06-25 22:45:15,414 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:45:19,095 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:45:19,095 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:45:21,343 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:45:21,343 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:45:21,349 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:45:21,349 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:45:21,357 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:45:21,357 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:45:21,357 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:45:21,357 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 20, 21, 357623), 'iat': datetime.datetime(2025, 6, 26, 5, 45, 21, 357626)}
2025-06-25 22:45:21,358 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:45:34,328 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:45:34,328 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:45:34,328 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750918473, 'iat': 1750916673}
2025-06-25 22:45:34,328 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750918473, 'iat': 1750916673}
2025-06-25 22:45:34,328 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:45:34,342 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:45:34,342 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:45:53,497 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:45:53,498 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:45:56,649 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:45:56,649 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:45:56,677 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:45:56,677 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:45:56,690 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:45:56,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:45:56,690 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:45:56,690 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 20, 56, 690111), 'iat': datetime.datetime(2025, 6, 26, 5, 45, 56, 690113)}
2025-06-25 22:45:56,690 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:46:14,210 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:46:14,211 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:46:14,216 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:46:14,216 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:46:14,225 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:46:14,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:46:14,226 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:46:14,226 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 21, 14, 225929), 'iat': datetime.datetime(2025, 6, 26, 5, 46, 14, 225933)}
2025-06-25 22:46:14,227 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:47:35,550 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:47:35,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:47:35,551 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750918473, 'iat': 1750916673}
2025-06-25 22:47:35,551 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750918473, 'iat': 1750916673}
2025-06-25 22:47:35,551 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:47:35,555 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:47:35,556 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,555 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,559 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,559 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,561 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:57:58,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,563 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,563 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:58,571 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:58,572 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,572 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,611 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,612 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:57:58,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,612 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:58,620 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:58,620 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,620 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,628 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:58,674 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:58,674 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:59,130 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:59,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:59,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,131 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,131 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:59,136 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:59,137 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:59,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:59,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:59,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:59,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:59,584 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,584 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,584 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:59,592 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:59,592 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:00,962 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:00,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:00,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:00,963 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:00,963 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:58:01,031 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:58:01,031 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:04,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:04,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:04,240 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:04,240 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:04,240 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:58:04,245 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:58:04,245 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:16,990 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:16,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:16,991 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:16,991 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:16,991 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:58:16,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:16,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:16,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:16,992 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:16,992 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:58:16,999 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:58:16,999 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:17,000 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:38,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:38,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:38,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:38,049 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:38,050 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:58:38,059 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:58:38,059 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:59:16,870 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:59:16,872 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:59:20,592 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:59:20,592 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:59:20,605 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:59:20,605 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:59:20,614 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:59:20,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:59:20,614 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:59:20,614 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 34, 20, 614224), 'iat': datetime.datetime(2025, 6, 26, 5, 59, 20, 614227)}
2025-06-25 22:59:20,614 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:59:22,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:59:22,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:59:22,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:01:24,723 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:01:24,724 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:05:41,071 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:05:41,071 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:05:41,088 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:05:41,088 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:05:41,103 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:05:41,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:05:41,103 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:05:41,103 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 40, 41, 103302), 'iat': datetime.datetime(2025, 6, 26, 6, 5, 41, 103306)}
2025-06-25 23:05:41,104 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:05:43,731 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:43,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:43,762 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:44,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:44,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:44,716 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:44,719 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:05:45,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:45,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:45,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:05:49,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:49,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:49,697 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:50,667 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:50,667 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:50,668 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:50,670 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:05:53,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:53,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:53,684 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:53,688 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:05:55,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:55,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:55,691 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:01,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:01,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:01,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:07,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:07,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:07,706 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:09,728 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:09,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:09,729 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:09,733 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:09,769 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:09,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:09,769 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:09,773 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:09,809 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:09,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:09,810 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:09,812 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:13,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:13,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:13,707 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:19,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:19,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:19,733 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:25,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:25,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:25,773 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:28,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:28,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:28,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:06:28,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:06:28,282 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:06:28,293 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:06:28,293 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:06:31,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:31,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:31,755 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:37,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:37,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:37,857 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:43,916 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:43,917 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:43,917 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:44,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:44,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:44,711 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:44,712 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:49,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:49,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:49,844 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:52,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:52,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:52,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:06:52,206 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:06:52,206 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:06:52,209 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:06:52,210 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:06:53,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:53,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:53,774 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:53,776 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:55,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:55,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:55,890 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:02,041 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:02,041 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:02,042 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:08,161 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:08,161 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:08,161 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,676 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:10,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:10,676 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,678 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:07:10,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:10,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:10,689 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,691 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:07:10,702 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:10,702 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:10,702 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,704 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:07:10,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:10,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:10,712 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,713 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:07:16,754 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:07:16,755 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:07:20,007 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:07:20,007 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:07:20,018 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:07:20,018 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:07:20,027 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:07:20,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:07:20,028 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:07:20,028 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 42, 20, 27923), 'iat': datetime.datetime(2025, 6, 26, 6, 7, 20, 27927)}
2025-06-25 23:07:20,028 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:07:23,642 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:07:23,643 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:07:26,667 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:07:26,668 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:07:26,677 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:07:26,677 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:07:26,692 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:07:26,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:07:26,692 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:07:26,692 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 42, 26, 692654), 'iat': datetime.datetime(2025, 6, 26, 6, 7, 26, 692658)}
2025-06-25 23:07:26,693 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:07:30,499 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:07:30,500 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:07:33,533 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:07:33,534 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:07:33,548 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:07:33,548 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:07:33,559 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:07:33,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:07:33,559 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:07:33,559 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 42, 33, 559465), 'iat': datetime.datetime(2025, 6, 26, 6, 7, 33, 559468)}
2025-06-25 23:07:33,560 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:07:35,978 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:35,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:35,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:07:58,251 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:07:58,251 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:08:01,515 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:08:01,515 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:08:01,526 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:08:01,526 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:08:01,533 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:08:01,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:08:01,534 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:08:01,534 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 43, 1, 533962), 'iat': datetime.datetime(2025, 6, 26, 6, 8, 1, 533965)}
2025-06-25 23:08:01,534 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:08:04,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:08:04,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:08:04,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:08:04,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:08:04,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:08:04,763 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:08:04,763 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:08:04,763 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:08:04,784 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:08:04,784 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:08:40,025 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:08:40,026 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:15:11,152 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:15:11,152 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:15:11,171 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:15:11,171 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:15:11,185 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:15:11,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:15:11,185 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:15:11,185 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 50, 11, 184979), 'iat': datetime.datetime(2025, 6, 26, 6, 15, 11, 184983)}
2025-06-25 23:15:11,186 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:15:13,572 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:15:13,572 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:15:13,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:15:20,462 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:15:20,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:15:20,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:15:20,463 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:15:20,463 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:15:20,474 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:15:20,475 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:15:59,440 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:15:59,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:15:59,441 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:15:59,441 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 26, 6, 45, 59, 440748), 'iat': datetime.datetime(2025, 6, 26, 6, 15, 59, 440756)}
2025-06-25 23:15:59,441 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:15:59,441 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTUyMzM1OSwiaWF0IjoxNzUwOTE4NTU5fQ.nEPxuTBKd4cEljInaOljF8BSWYFcQx-PnPFlRmYbkCE, Expiry (seconds): 604800
2025-06-25 23:15:59,446 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-25 23:16:49,898 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:16:49,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:16:49,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:16:49,899 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:16:49,899 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:16:49,905 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:16:49,905 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:16:59,718 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:16:59,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:16:59,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:16:59,719 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:16:59,719 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:16:59,722 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:16:59,723 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:17:20,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:17:20,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:17:20,596 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:17:20,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:17:20,596 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:17:20,601 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:17:20,601 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:17:53,079 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:17:53,079 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:21:46,082 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:21:46,083 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:21:46,107 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:21:46,107 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:21:46,117 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:21:46,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:21:46,117 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:21:46,117 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 56, 46, 117730), 'iat': datetime.datetime(2025, 6, 26, 6, 21, 46, 117734)}
2025-06-25 23:21:46,119 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:22:01,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,453 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,453 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:22:01,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,454 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,454 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,454 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,454 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:01,468 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:01,468 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,468 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,499 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,500 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,501 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,501 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:22:01,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,501 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,501 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,501 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:01,513 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:01,514 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,514 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,522 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:01,543 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:01,543 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,966 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:01,976 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:01,977 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:02,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:02,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:02,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,018 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:02,033 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:02,033 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:02,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:02,314 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:02,314 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:02,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:02,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,883 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,883 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:02,897 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:02,897 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:05,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:05,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:05,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:05,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:05,803 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:05,813 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:05,813 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:12,549 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:12,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:12,549 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:12,549 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:12,550 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:22:12,550 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:12,550 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:12,551 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:12,551 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:12,551 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:12,558 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:12,558 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:12,559 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:19,952 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:19,952 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:19,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:19,953 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:19,953 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:19,967 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:19,967 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:37,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:37,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:37,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:37,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:37,291 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:37,300 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:37,301 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:23:20,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:23:20,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:23:20,955 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:23:20,955 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:23:20,955 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:23:20,978 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:23:20,979 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:23:33,268 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:23:33,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:23:33,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:23:33,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:23:33,269 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:23:33,272 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:23:33,273 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:23:35,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:23:35,577 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:23:35,577 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:23:35,577 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:23:35,577 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:23:35,582 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:23:35,582 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:24:03,552 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:24:03,552 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:24:06,728 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:24:06,728 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:24:06,738 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:24:06,738 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:24:06,748 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:24:06,749 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:24:06,749 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:24:06,749 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 59, 6, 748922), 'iat': datetime.datetime(2025, 6, 26, 6, 24, 6, 748926)}
2025-06-25 23:24:06,749 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:24:08,809 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:24:08,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:24:08,809 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:25:09,599 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:25:09,599 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:25:12,867 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:25:12,867 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:25:12,879 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:25:12,879 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:25:12,886 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:25:12,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:25:12,886 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:25:12,886 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 0, 12, 886077), 'iat': datetime.datetime(2025, 6, 26, 6, 25, 12, 886080)}
2025-06-25 23:25:12,886 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:25:16,574 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:25:16,575 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:25:19,794 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:25:19,795 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:25:19,806 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:25:19,806 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:25:19,820 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:25:19,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:25:19,820 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:25:19,820 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 0, 19, 820036), 'iat': datetime.datetime(2025, 6, 26, 6, 25, 19, 820043)}
2025-06-25 23:25:19,821 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:25:51,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:25:51,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:25:51,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:02,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:26:02,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:26:02,969 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:02,969 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:02,969 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:26:02,974 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:26:02,974 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:26:26,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:26:26,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:26:26,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:26,695 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:26,695 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:26:26,726 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:26:26,728 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:26:49,251 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:26:49,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:26:49,252 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:49,252 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:49,252 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:26:49,261 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:26:49,261 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:27:09,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:09,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:09,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:09,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:09,386 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:27:09,395 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:27:09,396 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:27:13,816 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:27:13,816 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:27:17,050 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:27:17,051 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:27:17,061 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:27:17,061 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:27:17,073 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:27:17,073 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:27:17,073 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:27:17,073 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 2, 17, 73689), 'iat': datetime.datetime(2025, 6, 26, 6, 27, 17, 73694)}
2025-06-25 23:27:17,074 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:27:18,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:18,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:18,860 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:25,278 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:27:25,279 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:27:27,963 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:27:27,964 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:27:27,975 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:27:27,975 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:27:27,986 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:27:27,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:27:27,986 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:27:27,986 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 2, 27, 986642), 'iat': datetime.datetime(2025, 6, 26, 6, 27, 27, 986647)}
2025-06-25 23:27:27,987 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:27:29,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:29,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:29,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:30,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:30,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:30,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:30,427 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:30,427 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:27:30,437 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:27:30,437 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:27:34,521 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:27:34,522 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:27:37,207 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:27:37,207 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:27:37,220 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:27:37,220 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:27:37,228 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:27:37,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:27:37,228 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:27:37,228 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 2, 37, 228180), 'iat': datetime.datetime(2025, 6, 26, 6, 27, 37, 228182)}
2025-06-25 23:27:37,228 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:27:39,209 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:27:39,210 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:27:45,596 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:27:45,597 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:27:45,625 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:27:45,625 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:27:45,642 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:27:45,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:27:45,642 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:27:45,642 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 2, 45, 642199), 'iat': datetime.datetime(2025, 6, 26, 6, 27, 45, 642206)}
2025-06-25 23:27:45,642 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:27:47,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:47,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:47,503 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:49,922 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:49,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:49,924 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:49,924 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:49,930 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:27:50,077 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:27:50,079 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:21,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:21,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:21,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:21,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:21,522 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:21,539 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:21,540 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,427 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,430 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,430 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:28:38,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,430 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,431 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,432 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:38,457 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:38,457 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,457 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,528 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,528 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:38,547 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:38,552 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,649 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,649 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:28:38,650 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,650 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,651 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,651 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,652 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:38,678 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:38,680 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,682 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,936 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,936 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,937 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,937 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:38,957 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:38,958 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:41,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:41,782 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:41,783 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:41,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:41,788 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:41,830 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:41,831 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:44,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:44,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:44,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:44,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:44,280 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:44,294 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:44,295 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:44,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:44,576 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:44,576 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:52,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:52,915 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:52,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:52,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:52,919 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:53,018 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:53,019 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:12,672 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:12,672 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:12,673 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:12,674 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:12,674 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:12,693 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:12,694 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:19,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:19,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:19,891 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:19,892 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:19,892 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:19,917 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:19,917 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:28,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:28,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:28,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:28,785 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:28,785 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:29:28,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:28,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:28,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:28,787 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:28,787 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:28,809 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:28,810 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:28,810 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:32,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:32,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:32,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:32,227 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:32,228 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:32,289 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:32,289 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:57,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:57,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:57,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:57,508 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:57,508 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:57,649 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:57,649 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:30:01,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:30:01,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:30:01,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:01,085 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:01,085 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:30:01,094 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:30:01,094 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:30:14,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:30:14,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:30:14,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:14,081 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:14,081 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:30:14,100 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:30:14,100 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:30:36,421 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:30:36,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:30:36,421 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:36,421 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:36,421 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:30:36,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:30:36,428 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:30:56,943 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:30:56,948 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:31:02,422 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:31:02,422 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:31:02,437 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:31:02,438 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:31:02,453 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:31:02,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:31:02,453 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:31:02,453 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 6, 2, 452967), 'iat': datetime.datetime(2025, 6, 26, 6, 31, 2, 452976)}
2025-06-25 23:31:02,454 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:31:04,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:04,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:04,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:04,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:04,243 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:04,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:04,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:04,248 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:31:04,249 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:31:04,249 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:31:04,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:04,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:04,254 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:04,456 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:04,456 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:04,465 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:31:04,465 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:31:27,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:27,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:27,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:27,202 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:27,202 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:27,212 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:27,213 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,110 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,111 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,111 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,111 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:31:33,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,112 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,112 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,112 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,159 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,160 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,184 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,184 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,184 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:31:33,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,184 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,184 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,184 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,199 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,199 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,199 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,222 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,222 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,222 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,238 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,238 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,535 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,536 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,553 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,554 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,905 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,905 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,905 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,913 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,914 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:34,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:34,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:34,233 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:34,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:34,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:34,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:34,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:34,581 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:34,600 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:34,601 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:40,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,062 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,081 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,162 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,162 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,163 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,167 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,204 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,213 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,274 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,275 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,297 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,299 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,320 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,323 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:43,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:43,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:43,115 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:43,117 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:44,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:44,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:44,706 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:44,708 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:45,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:45,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:45,674 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:49,792 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:49,792 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:49,793 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:49,795 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:49,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:49,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:49,836 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:49,838 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:53,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:53,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:53,201 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:53,203 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:53,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:53,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:53,235 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:53,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:53,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:53,535 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:53,537 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:59,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:59,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:59,669 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:01,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:01,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:01,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:01,100 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:01,100 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:32:01,109 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:32:01,109 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:32:05,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:05,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:05,754 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:07,973 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:07,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:07,973 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:07,975 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:32:11,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:11,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:11,726 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:17,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:17,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:17,676 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:23,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:23,670 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:23,670 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:27,682 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:27,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:27,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:27,682 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:27,682 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:32:27,686 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:32:27,686 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:32:29,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:29,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:29,666 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:35,682 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:35,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:35,682 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:41,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:41,680 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:41,680 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:43,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:43,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:43,685 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:43,686 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:32:44,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:44,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:44,678 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:44,679 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:32:45,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:45,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:45,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:45,289 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:45,289 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:32:45,292 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:32:45,292 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:32:47,667 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:47,667 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:47,668 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:53,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:53,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:53,679 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:59,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:59,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:59,700 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:05,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:05,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:05,697 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:06,508 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:06,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:06,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:06,509 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:06,509 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:33:06,517 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:33:06,517 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:33:08,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,673 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,675 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:08,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,696 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,697 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:08,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,709 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,710 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:08,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,731 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,732 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:08,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,749 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,751 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:11,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:11,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:11,696 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:17,842 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:33:17,842 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:33:20,896 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:33:20,896 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:33:20,909 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:33:20,910 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:33:20,923 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:33:20,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:33:20,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:33:20,923 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 8, 20, 923014), 'iat': datetime.datetime(2025, 6, 26, 6, 33, 20, 923018)}
2025-06-25 23:33:20,923 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:33:22,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:22,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:22,596 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:22,990 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:22,990 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:22,991 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:25,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:25,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:25,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:25,107 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:25,108 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:33:25,128 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:33:25,129 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:33:27,692 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:27,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:27,693 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:29,296 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:33:29,297 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:33:34,070 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:33:34,070 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:33:34,096 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:33:34,097 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:33:34,112 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:33:34,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:33:34,112 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:33:34,112 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 8, 34, 112420), 'iat': datetime.datetime(2025, 6, 26, 6, 33, 34, 112423)}
2025-06-25 23:33:34,112 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:33:36,172 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:33:36,173 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:33:41,393 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:33:41,394 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:33:41,425 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:33:41,425 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:33:41,443 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:33:41,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:33:41,444 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:33:41,444 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 8, 41, 443852), 'iat': datetime.datetime(2025, 6, 26, 6, 33, 41, 443866)}
2025-06-25 23:33:41,445 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:33:43,192 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:43,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:43,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:43,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:43,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:43,687 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:43,691 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:45,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:45,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:45,045 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:52,246 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:33:52,246 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:33:58,082 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:33:58,082 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:33:58,090 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:33:58,090 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:33:58,103 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:33:58,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:33:58,103 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:33:58,103 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 8, 58, 103140), 'iat': datetime.datetime(2025, 6, 26, 6, 33, 58, 103143)}
2025-06-25 23:33:58,103 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:33:59,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:59,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:59,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:59,844 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:59,845 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:33:59,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:59,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:59,848 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:59,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:59,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:59,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:00,243 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:00,244 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:09,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:09,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:09,969 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:09,969 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:09,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:09,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:09,980 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,234 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,236 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:10,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,247 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,249 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:10,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,265 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,266 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,267 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:10,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,280 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,283 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:10,298 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,298 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,299 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,301 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:18,031 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:18,031 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:18,032 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:18,032 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:18,032 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:34:18,046 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:18,068 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:18,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:18,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:18,182 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:18,183 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:18,183 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:34:18,221 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:18,222 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:20,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:20,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:20,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:27,333 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:27,334 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:27,334 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:27,334 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:27,335 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:34:27,361 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:27,361 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:28,491 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:28,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:28,498 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:28,498 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:28,501 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:34:28,518 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:28,519 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:30,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:30,786 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:30,786 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:40,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:40,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:40,662 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:43,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:43,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:43,675 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:43,677 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:51,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:51,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:51,439 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:35:00,146 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:00,146 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:00,147 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:35:03,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:03,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:03,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:03,213 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:03,213 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:35:03,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:03,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:03,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:03,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:03,214 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:03,227 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:03,227 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:03,227 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:18,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:18,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:18,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:18,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:18,149 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:18,156 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:18,157 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:24,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:24,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:24,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:24,936 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:24,936 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:24,946 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:24,947 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:37,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:37,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:37,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:37,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:37,886 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:37,890 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:37,890 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:42,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:42,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:42,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:35:42,066 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:35:42,066 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:35:42,072 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:35:42,072 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:35:59,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:59,430 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:59,430 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:59,430 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:59,430 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:59,435 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:59,436 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:36:20,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:36:20,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:36:20,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:20,319 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:20,319 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:36:20,324 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:36:20,324 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:36:24,610 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:36:24,611 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:36:27,704 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:36:27,704 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:36:27,716 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:36:27,716 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:36:27,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:36:27,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:36:27,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:36:27,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 11, 27, 723321), 'iat': datetime.datetime(2025, 6, 26, 6, 36, 27, 723323)}
2025-06-25 23:36:27,723 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:36:29,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:36:29,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:36:29,991 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:41,113 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:36:41,113 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:36:41,114 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:41,114 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:41,114 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:36:41,122 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:36:41,123 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:37:00,925 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:37:00,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:37:00,926 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:37:00,926 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:37:00,926 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:37:00,945 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:37:00,946 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:37:07,127 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:37:07,129 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:39:28,454 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:39:28,454 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:39:28,499 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:39:28,499 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:39:30,154 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:39:30,154 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:39:30,167 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:39:30,167 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:39:30,180 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:39:30,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:39:30,180 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:39:30,180 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 14, 30, 180155), 'iat': datetime.datetime(2025, 6, 26, 6, 39, 30, 180161)}
2025-06-25 23:39:30,181 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:39:37,349 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:37,349 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:37,351 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:39:37,727 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:37,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:37,729 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:39:37,729 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:39:37,730 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:37,824 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:37,825 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,658 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,658 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:39:50,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,659 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,659 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:50,688 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:50,688 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,691 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,766 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,766 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:39:50,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,769 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,770 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:50,844 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:50,845 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,852 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,922 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,923 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,923 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:50,993 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:50,997 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:53,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:53,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:53,574 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:53,623 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:53,623 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:54,232 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:54,233 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:55,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:55,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:55,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:55,145 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:55,145 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:55,213 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:55,214 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:55,510 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:55,510 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:55,511 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:03,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:03,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:03,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:03,526 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:03,526 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:03,586 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:03,587 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:10,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:10,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:10,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:11,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:11,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:11,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:11,436 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:11,436 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:11,651 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:11,665 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:20,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:20,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:20,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:20,726 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:20,726 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:20,739 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:20,740 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:30,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:30,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:30,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:30,095 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:30,095 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:40:30,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:30,096 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:30,096 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:30,096 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:30,096 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:30,104 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:30,105 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:30,105 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:32,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:32,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:32,541 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:32,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:32,541 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:32,599 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:32,600 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:54,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:54,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:54,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:54,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:54,635 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:54,648 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:54,649 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:41:19,970 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:41:19,970 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:41:19,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:41:19,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:41:19,972 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:41:19,980 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:41:19,980 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:41:23,412 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:41:23,412 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:41:23,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:41:23,413 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:41:23,413 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:41:23,439 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:41:23,440 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:41:50,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:41:50,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:41:50,145 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:41:50,146 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:41:50,146 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:41:50,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:41:50,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:42:10,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:42:10,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:42:10,639 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:10,639 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:10,639 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:42:10,648 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:42:10,648 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:42:32,855 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:42:32,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:42:32,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:32,857 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:32,857 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:42:32,880 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:42:32,882 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:42:34,482 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:42:34,483 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:42:34,483 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:34,484 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:34,484 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:42:34,495 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:42:34,496 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:42:53,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:42:53,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:42:53,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:53,279 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:53,279 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:42:53,286 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:42:53,287 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:43:22,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:43:22,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:43:22,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:43:22,835 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:43:22,835 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:43:22,841 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:43:22,841 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:43:40,204 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:43:40,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:43:40,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:43:40,205 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:43:40,205 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:43:40,219 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:43:40,219 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:44:01,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:44:01,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:44:01,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:01,196 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:01,196 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:44:01,203 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:44:01,203 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:44:22,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:44:22,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:44:22,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:22,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:22,611 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:44:22,614 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:44:22,614 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:44:41,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:44:41,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:44:41,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:41,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:41,803 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:44:41,811 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:44:41,811 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:44:42,802 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:44:42,805 - INFO - app.core.security - Redis connection closed.
2025-06-26 00:17:59,637 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 00:17:59,637 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 00:17:59,747 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 00:17:59,747 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 00:17:59,812 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 00:17:59,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 00:17:59,812 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 00:17:59,812 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 52, 59, 812286), 'iat': datetime.datetime(2025, 6, 26, 7, 17, 59, 812292)}
2025-06-26 00:17:59,823 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 00:18:02,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,198 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,206 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,233 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,261 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,262 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,265 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,288 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,289 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,306 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,307 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,330 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,430 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,448 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,505 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,506 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,511 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,728 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,729 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,749 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,750 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,757 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,821 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,823 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,842 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,844 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,868 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,868 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,869 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,872 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,907 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,924 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,924 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,927 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,950 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,952 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,956 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,975 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,976 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,978 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,996 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,996 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,999 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,018 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,021 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,037 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,037 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,038 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,040 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,062 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,065 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,088 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,090 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,114 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,115 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,117 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,139 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,141 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,163 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,164 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,166 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,187 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,204 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,207 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,222 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,225 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,245 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,247 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,270 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,272 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,290 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,293 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,311 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,313 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,331 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,332 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,334 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,352 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,353 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,355 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,374 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,376 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,415 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,417 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,435 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,437 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,457 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,458 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,460 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,478 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,479 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,482 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,499 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,500 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,501 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,518 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,519 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,541 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,541 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,543 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,562 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,564 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:14,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,427 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,427 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 00:18:14,427 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,428 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,428 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:14,464 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:14,464 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:14,465 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:14,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,495 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,495 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 00:18:14,496 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,496 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,497 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,497 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:14,515 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:14,516 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:14,516 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:14,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,526 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,526 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:14,558 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:14,559 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:15,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:15,411 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:15,412 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:15,412 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:15,412 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:15,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:15,428 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:15,745 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:15,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:15,746 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:16,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:16,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,659 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:16,671 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:16,671 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:16,717 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:16,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:16,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,719 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,719 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:16,746 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:16,746 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:21,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:21,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:21,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:21,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:21,752 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:21,767 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:21,768 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:19:11,166 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:19:11,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:19:11,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:11,168 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:11,168 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 00:19:11,168 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:19:11,168 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:19:11,169 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:11,169 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:11,169 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:19:11,191 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:19:11,192 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:19:11,198 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:19:21,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:19:21,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:19:21,181 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:21,181 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:21,181 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:19:21,195 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:19:21,196 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:19:36,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:19:36,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:19:36,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:36,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:36,966 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:19:36,984 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:19:36,984 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:20:21,663 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 00:20:21,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 00:20:21,664 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 00:20:21,664 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 26, 7, 50, 21, 663887), 'iat': datetime.datetime(2025, 6, 26, 7, 20, 21, 663900)}
2025-06-26 00:20:21,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 00:20:21,665 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTUyNzIyMSwiaWF0IjoxNzUwOTIyNDIxfQ.ENerHvnXOjEumwM2anaZBp09oQAFBPPOWiiFBBTtARQ, Expiry (seconds): 604800
2025-06-26 00:20:21,670 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-26 00:20:36,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:20:36,586 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:20:36,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750924221, 'iat': 1750922421}
2025-06-26 00:20:36,587 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750924221, 'iat': 1750922421}
2025-06-26 00:20:36,587 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 00:20:36,599 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 00:20:36,599 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 00:20:38,130 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:20:38,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:20:38,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:20:38,131 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:20:38,131 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:20:38,157 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:20:38,157 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:20:58,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:20:58,218 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:20:58,218 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:20:58,218 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:20:58,218 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:20:58,224 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:20:58,224 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:21:11,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:11,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:11,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750924221, 'iat': 1750922421}
2025-06-26 00:21:11,050 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750924221, 'iat': 1750922421}
2025-06-26 00:21:11,050 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 00:21:11,068 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 00:21:11,068 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 00:21:20,081 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:20,081 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:20,082 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,082 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,082 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:21:20,116 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:21:20,118 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:21:20,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:20,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:20,839 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,839 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,840 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:21:20,866 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:21:20,867 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:21:20,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:20,982 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:20,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,985 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,986 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:21:21,044 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:21:21,045 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:21:24,391 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:24,391 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:24,391 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:24,392 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:24,392 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:21:24,416 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:21:24,416 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:22:20,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:22:20,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:22:20,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:22:20,962 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:22:20,962 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:22:21,079 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:22:21,093 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:23:23,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:23:23,610 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:23:23,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:23:23,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:23:23,612 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:23:23,658 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:23:23,659 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:24:21,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:24:21,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:24:21,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:24:21,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:24:21,282 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:24:21,409 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:24:21,409 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:25:21,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:25:21,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:25:21,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:25:21,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:25:21,068 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:25:21,088 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:25:21,090 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:26:23,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:26:23,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:26:23,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:26:23,357 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:26:23,358 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:26:23,432 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:26:23,434 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:27:21,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:27:21,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:27:21,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:27:21,176 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:27:21,179 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:27:21,204 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:27:21,205 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:34:03,596 - INFO - app.core.security - Closing Redis connection...
2025-06-26 01:34:03,607 - INFO - app.core.security - Redis connection closed.
2025-06-26 01:48:49,943 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 01:48:49,944 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 01:48:49,977 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 01:48:49,977 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 01:48:49,985 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:48:49,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:48:49,985 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:48:49,985 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 23, 49, 985305), 'iat': datetime.datetime(2025, 6, 26, 8, 48, 49, 985307)}
2025-06-26 01:48:49,986 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:49:08,415 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:49:08,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:49:08,415 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:49:08,415 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 9, 19, 8, 415259), 'iat': datetime.datetime(2025, 6, 26, 8, 49, 8, 415263)}
2025-06-26 01:49:08,415 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:49:08,415 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MzI1NDgsImlhdCI6MTc1MDkyNzc0OH0.1j5jYdeN4d2sbO5ZZTma9msFq3QiZUOnSj38NOoXFEY, Expiry (seconds): 604800
2025-06-26 01:49:08,428 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-26 01:50:10,508 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:50:10,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:50:10,509 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:50:10,509 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 9, 20, 10, 508903), 'iat': datetime.datetime(2025, 6, 26, 8, 50, 10, 508911)}
2025-06-26 01:50:10,509 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:50:10,510 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MzI2MTAsImlhdCI6MTc1MDkyNzgxMH0.fqWvkMt9pXkyQvgQbzFFgKMIls1laLzZAl2nkb_W_Ok, Expiry (seconds): 604800
2025-06-26 01:50:10,518 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-26 01:50:37,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,468 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,502 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,530 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,531 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,536 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,646 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,669 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,681 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,739 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,748 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,901 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:54,178 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:50:54,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:50:54,178 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:50:54,178 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 26, 9, 20, 54, 178196), 'iat': datetime.datetime(2025, 6, 26, 8, 50, 54, 178203)}
2025-06-26 01:50:54,178 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:50:54,179 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1MzI2NTQsImlhdCI6MTc1MDkyNzg1NH0.mHvB54Mcr2xYgCxNjNY9B7WxglzULtRXe29eAt9tRsA, Expiry (seconds): 604800
2025-06-26 01:50:54,184 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-26 01:50:55,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,283 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,283 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 01:50:55,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,285 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,285 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,285 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:55,315 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:55,316 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,316 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,345 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,346 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,346 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 01:50:55,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,349 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,350 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,350 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:55,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,395 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,398 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:55,421 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:55,424 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,424 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,434 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,434 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:55,552 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:55,552 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,582 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:55,582 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:56,503 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:56,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:56,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:56,509 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:56,510 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:56,533 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:56,534 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:56,828 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:56,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:56,828 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:58,154 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:58,156 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:58,156 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:58,157 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:58,157 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:58,195 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:58,196 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:52:10,895 - INFO - app.core.security - Closing Redis connection...
2025-06-26 01:52:10,897 - INFO - app.core.security - Redis connection closed.
2025-06-26 01:59:18,810 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 01:59:18,810 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 01:59:18,822 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 01:59:18,822 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 01:59:18,832 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:59:18,832 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:59:18,832 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:59:18,832 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 34, 18, 832278), 'iat': datetime.datetime(2025, 6, 26, 8, 59, 18, 832280)}
2025-06-26 01:59:18,833 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:59:24,664 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:24,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:24,665 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:59:31,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:31,098 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:31,099 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:59:31,099 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:59:31,099 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:59:31,127 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:59:31,128 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:59:31,128 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA5Mjk2NTQsImlhdCI6MTc1MDkyNzg1NH0.Yg718RCN7SRlUNPOgsWMKePeQf5zWGjcOPhyeXkAwjk
2025-06-26 01:59:31,136 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA5Mjk2NTQsImlhdCI6MTc1MDkyNzg1NH0.Yg718RCN7SRlUNPOgsWMKePeQf5zWGjcOPhyeXkAwjk
2025-06-26 01:59:44,296 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:59:44,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:59:44,296 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:59:44,296 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 26, 9, 29, 44, 295961), 'iat': datetime.datetime(2025, 6, 26, 8, 59, 44, 295972)}
2025-06-26 01:59:44,296 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:59:44,297 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MzMxODQsImlhdCI6MTc1MDkyODM4NH0.1JS9Z8yIrwOReJ_tt4AQDpYVI1TelH2GaesH8ugfE1U, Expiry (seconds): 604800
2025-06-26 01:59:44,302 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-26 01:59:45,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,419 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,419 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 01:59:45,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,420 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:45,435 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:45,443 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:45,445 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:45,477 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,496 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,497 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,498 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 01:59:45,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,508 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,508 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,509 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:45,549 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,553 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,553 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:45,581 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:45,582 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:45,582 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:45,595 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:45,596 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:46,852 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:46,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:46,853 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:46,853 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:46,853 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:46,864 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:46,864 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:47,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:47,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:47,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:47,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:47,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:47,977 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:47,977 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:47,977 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:48,094 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:48,095 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:48,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:48,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:48,529 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:48,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:48,530 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:48,557 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:48,560 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:17,705 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:17,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:17,706 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:17,706 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:17,707 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:17,726 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:17,726 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:19,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:19,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:19,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:19,229 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:19,230 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:19,266 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:19,267 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:21,020 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:21,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:21,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:21,021 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:21,021 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:21,032 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:21,033 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:23,097 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:23,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:23,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:23,098 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:23,098 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:23,103 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:23,103 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:44,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:44,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:44,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:44,773 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:44,774 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:00:44,774 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:44,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:44,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:44,777 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:44,777 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:44,816 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:44,817 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:44,822 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:01:12,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:01:12,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:01:12,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:01:12,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:01:12,794 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:01:12,806 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:01:12,806 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:01:53,333 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:01:53,333 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:01:53,333 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:01:53,333 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 26, 9, 31, 53, 333357), 'iat': datetime.datetime(2025, 6, 26, 9, 1, 53, 333360)}
2025-06-26 02:01:53,333 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:01:53,334 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTUzMzMxMywiaWF0IjoxNzUwOTI4NTEzfQ.P6OMud71udFN0gI6lY9ZnPkM07q7Rk0rwEioCvOpZPc, Expiry (seconds): 604800
2025-06-26 02:01:53,336 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-26 02:02:07,852 - DEBUG - app.core.security - Attempting to decode token: generate_unique_10_digit_id...
2025-06-26 02:02:07,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:02:07,852 - WARNING - app.core.security - JWTError in decode_token: JWTError - Not enough segments
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 180, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 74, in verify
    header, payload, signing_input, signature = _load(token)
                                                ~~~~~^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 184, in _load
    raise JWSError("Not enough segments")
jose.exceptions.JWSError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Not enough segments
2025-06-26 02:02:07,860 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 180, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 74, in verify
    header, payload, signing_input, signature = _load(token)
                                                ~~~~~^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 184, in _load
    raise JWSError("Not enough segments")
jose.exceptions.JWSError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 02:02:25,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:02:25,087 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:02:25,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:02:25,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:02:25,088 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:02:25,092 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:02:25,092 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:02:30,173 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:02:30,174 - INFO - app.core.security - Redis connection closed.
2025-06-26 02:05:49,895 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 02:05:49,896 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 02:05:49,914 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 02:05:49,914 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 02:05:49,921 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:05:49,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:05:49,921 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:05:49,921 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 40, 49, 921754), 'iat': datetime.datetime(2025, 6, 26, 9, 5, 49, 921757)}
2025-06-26 02:05:49,922 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:05:51,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:05:51,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:05:51,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:05,124 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:05,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:05,124 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:06:05,124 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:06:05,124 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:06:05,128 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:06:05,129 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:06:13,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:13,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:13,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:13,938 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:13,938 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:06:13,946 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:06:13,946 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:06:14,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:14,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:14,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:14,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:14,742 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:06:14,746 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:06:14,746 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:06:28,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:28,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:28,715 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:28,715 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:28,716 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:06:28,732 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:06:28,732 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:06:30,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:30,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:30,884 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:30,885 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:30,885 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:06:30,974 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:06:30,974 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:06:51,043 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:06:51,044 - INFO - app.core.security - Redis connection closed.
2025-06-26 02:10:07,662 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 02:10:07,662 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 02:10:07,697 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 02:10:07,697 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 02:10:07,705 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:10:07,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:10:07,705 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:10:07,705 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 45, 7, 705555), 'iat': datetime.datetime(2025, 6, 26, 9, 10, 7, 705559)}
2025-06-26 02:10:07,706 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:10:14,544 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:14,544 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:14,544 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,970 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:28,970 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:28,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,970 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,971 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:10:28,971 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:28,971 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:28,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,971 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:28,988 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:28,988 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:28,989 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:29,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:29,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:29,035 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,037 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:29,061 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:29,061 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:29,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:29,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:29,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,108 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,108 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:10:29,109 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:29,109 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:29,109 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,111 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,112 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:29,130 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:29,130 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:29,131 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:29,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:29,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:29,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,410 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,410 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:29,429 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:29,430 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:30,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:30,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:30,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:30,947 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:30,947 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:30,963 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:30,964 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:31,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:31,314 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:31,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:31,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:31,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:31,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:31,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:31,946 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:32,200 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:32,200 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:33,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:33,096 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:33,097 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:33,097 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:33,097 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:33,120 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:33,121 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:45,699 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:45,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:45,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:45,700 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:45,700 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:10:45,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:45,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:45,704 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:45,705 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:45,705 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:45,729 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:45,729 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:45,732 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:12,009 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:12,009 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:12,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:12,012 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:12,012 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:12,042 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:12,044 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:33,395 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:33,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:33,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:11:33,396 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:11:33,396 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:11:33,398 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:11:33,398 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:11:49,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,101 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,101 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:11:49,101 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,103 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,104 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:49,120 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:49,121 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,121 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,150 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:49,162 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:49,163 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,187 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,188 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,188 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:11:49,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,188 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:49,195 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:49,196 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,196 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,245 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,246 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,247 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:49,257 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:49,258 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:50,004 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:50,004 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:50,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,006 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,006 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:50,016 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:50,016 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:50,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:50,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:50,417 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:50,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:50,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,848 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:50,861 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:50,862 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:12:09,402 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:12:09,402 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:12:09,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:09,404 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:09,404 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:12:09,424 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:12:09,425 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:12:20,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:12:20,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:12:20,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:20,919 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:20,919 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:12:20,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:12:20,920 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:12:20,920 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:20,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:20,920 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:12:20,927 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:12:20,928 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:12:20,928 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:12:38,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:12:38,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:12:38,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:38,977 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:38,977 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:12:38,989 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:12:38,989 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:13:09,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:13:09,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:13:09,939 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:13:09,939 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:13:09,939 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:13:09,944 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:13:09,945 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:13:21,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:13:21,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:13:21,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:13:21,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:13:21,487 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:13:21,497 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:13:21,497 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:13:55,311 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:13:55,311 - INFO - app.core.security - Redis connection closed.
2025-06-26 02:17:37,610 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 02:17:37,610 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 02:17:37,630 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 02:17:37,630 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 02:17:37,638 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:17:37,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:17:37,638 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:17:37,638 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 52, 37, 638879), 'iat': datetime.datetime(2025, 6, 26, 9, 17, 37, 638881)}
2025-06-26 02:17:37,639 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:17:42,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:17:42,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:17:42,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,255 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,255 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:18:22,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,255 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,255 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,268 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,269 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,269 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,281 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,281 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,282 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,286 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,286 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,286 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,291 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,295 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,295 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,560 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,560 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,560 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,560 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,564 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,564 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,795 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,795 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,795 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,798 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,798 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:23,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:23,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:23,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:23,043 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:23,043 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:23,046 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:23,047 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:23,105 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:23,105 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:23,106 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:25,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:25,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:25,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:25,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:25,536 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:25,543 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:25,543 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:37,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:37,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:37,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:37,695 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:37,695 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:18:37,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:37,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:37,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:37,695 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:37,695 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:37,710 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:37,710 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:37,710 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:19:05,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:19:05,501 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:19:05,501 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:19:05,502 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:19:05,502 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:19:05,513 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:19:05,514 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:19:26,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:19:26,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:19:26,068 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:19:26,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:19:26,068 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:19:26,077 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:19:26,078 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:19:38,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:19:38,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:19:38,711 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:19:38,711 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:19:38,711 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:19:38,715 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:19:38,715 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:21:20,720 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:21:20,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:21:20,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:21:20,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:21:20,720 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:21:20,733 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:21:20,733 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:21:24,439 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:21:24,439 - INFO - app.core.security - Redis connection closed.
